# CurrencyConverter
Ïä§ÌååÎ•¥ÌÉÄ Ï∫†ÌîÑÏóêÏÑú ÏßÑÌñâÌïú ÌôòÏú® Í≥ÑÏÇ∞Í∏∞ Ïï±ÏûÖÎãàÎã§. Ïà´Ïûê Îç∞Ïù¥ÌÑ∞Î•º ÏÇ¨ÎûåÏù¥ Ïù¥Ìï¥ÌïòÍ∏∞ Ïâ¨Ïö¥ UIÎ°ú Î∞îÍæ∏Í≥†, ÏÇ¨Ïö©ÏûêÏùò Îß•ÎùΩÏùÑ ÏûÉÏßÄ ÏïäÎèÑÎ°ù ÏÉÅÌÉúÎ•º Ï†ÄÏû•¬∑Î≥µÏõêÌïòÎäî Îç∞ Ï¥àÏ†êÏùÑ ÎßûÏ∑ÑÏäµÎãàÎã§.

## ÌïµÏã¨ Í∏∞Îä•
- **ÌôòÏú® Ìä∏Î†åÎìú ÏïÑÏù¥ÏΩò (Level 8)**: Ïù¥Ï†Ñ Ïä§ÎÉÖÏÉ∑Í≥º ÏµúÏã† ÌôòÏú®ÏùÑ ÎπÑÍµêÌï¥ ÏÉÅÏäπ üîº / ÌïòÎùΩ üîΩ / Î≥¥Ìï© Ïó¨Î∂ÄÎ•º ÌëúÏãúÌï©ÎãàÎã§. Î≥ÄÎèôÎüâÏù¥ `¬±0.01` Ïù¥ÌïòÏùº ÎïåÎäî ÏïÑÏù¥ÏΩò ÎåÄÏã† Ï†ïÎ†¨Ïö© Ïó¨Î∞±Îßå ÎëêÏñ¥ UIÍ∞Ä ÌùîÎì§Î¶¨ÏßÄ ÏïäÎèÑÎ°ù ÌñàÏäµÎãàÎã§.
- **Ïï± ÏÉÅÌÉú Ï†ÄÏû• & Î≥µÏõê (Level 10)**: ÎßàÏßÄÎßâÏúºÎ°ú Î≥∏ ÌôîÎ©¥(Î¶¨Ïä§Ìä∏/Í≥ÑÏÇ∞Í∏∞)Í≥º ÌÜµÌôî Ï†ïÎ≥¥Î•º SwiftDataÏóê Ï†ÄÏû•Ìï¥, Ïï±ÏùÑ Ïû¨ÏãúÏûëÌï¥ÎèÑ Ï¶âÏãú ÎèôÏùºÌïú Îß•ÎùΩÏúºÎ°ú Î≥µÍ∑ÄÌï©ÎãàÎã§. Í≥ÑÏÇ∞Í∏∞Ïùò ÏûÖÎ†• Í∞íÍ≥º Í≤∞Í≥ºÎäî ÏùºÏãúÏ†Å ÏÉÅÌÉúÎ°ú Í∞ÑÏ£ºÌï¥ Ï†ÄÏû•ÌïòÏßÄ ÏïäÏäµÎãàÎã§.
- **ÌôòÏú® Ï∫êÏãú Ïä§ÎÉÖÏÉ∑**: ÏµúÏã† ÌôòÏú®ÏùÑ ÎÑ§Ìä∏ÏõåÌÅ¨ÏóêÏÑú Í∞ÄÏ†∏Ïò§Í∏∞ Ï†ÑÍπåÏßÄ Ï∫êÏãúÎêú Îç∞Ïù¥ÌÑ∞Î•º Î®ºÏ†Ä ÎÖ∏Ï∂úÌï¥ Ï¥àÍ∏∞ ÌëúÏãú ÏÜçÎèÑÎ•º ÎÜíÏòÄÏäµÎãàÎã§.

## Level 11 ‚Äì Î©îÎ™®Î¶¨ Ïù¥Ïäà ÎîîÎ≤ÑÍπÖ Í≤ΩÌóò
Combine Î∞îÏù∏Îî© Í≥ºÏ†ïÏóêÏÑú `CurrencyViewController`Í∞Ä Î©îÎ™®Î¶¨ÏóêÏÑú Ìï¥Ï†úÎêòÏßÄ ÏïäÎäî ÎàÑÏàòÎ•º Î∞úÍ≤¨ÌñàÏäµÎãàÎã§. Î¨∏Ï†ú Ï†ïÏùò ‚Üí Î∂ÑÏÑù ‚Üí Ìï¥Í≤∞ ‚Üí Í≤ÄÏ¶ùÍπåÏßÄ Xcode Ìà¥ÏùÑ ÌôúÏö©Ìï¥ Ï†ïÎ¶¨ÌñàÏäµÎãàÎã§.

### 1. Î¨∏Ï†ú Ï†ïÏùò
- **Ï¶ùÏÉÅ**: ÌôòÏú® Î™©Î°ù ‚Üí Í≥ÑÏÇ∞Í∏∞ ÌôîÎ©¥ Ï†ÑÌôò ÌõÑ, ÌôîÎ©¥ÏùÑ Îã´ÏïÑÎèÑ `CurrencyViewController` Ïù∏Ïä§ÌÑ¥Ïä§Í∞Ä Î©îÎ™®Î¶¨Ïóê ÎÇ®ÏïÑ ÏûàÏùå.
- **Í∏∞ÎåÄ ÌñâÎèô**: ÎÑ§ÎπÑÍ≤åÏù¥ÏÖò Ïä§ÌÉùÏóêÏÑú popÎêòÎ©¥ ViewControllerÍ∞Ä Ï¶âÏãú Ìï¥Ï†úÎêòÏñ¥Ïïº Ìï®.

### 2. Î∂ÑÏÑù Í≥ºÏ†ï (Xcode Memory Graph Debugger)
1. ÏãúÎÆ¨Î†àÏù¥ÌÑ∞ÏóêÏÑú Î™©Î°ù ‚Üî Í≥ÑÏÇ∞Í∏∞ ÌôîÎ©¥ÏùÑ Î∞òÎ≥µ Ï†ÑÌôò.
2. Memory Graph Debugger Ïã§Ìñâ ‚Üí pop ÌõÑÏóêÎèÑ `CurrencyViewController` Ïù∏Ïä§ÌÑ¥Ïä§Í∞Ä Ï°¥Ïû¨.
3. Í∑∏ÎûòÌîÑÎ•º Îî∞ÎùºÍ∞Ä Î≥¥Îãà `CurrencyViewController ‚Üí BaseViewController.cancellables ‚Üí AnyCancellable ‚Üí Combine ÌÅ¥Î°úÏ†Ä ‚Üí CurrencyViewController` Í≤ΩÎ°úÎ°ú Í∞ïÌïú Ï∞∏Ï°∞ ÏàúÌôòÏù¥ ÌòïÏÑ±.

### 3. Ï∂îÍ∞Ä Í≤ÄÏ¶ù (Instruments ‚Äì Leaks)
- ÎèôÏùº ÏãúÎÇòÎ¶¨Ïò§Î•º Instruments LeaksÎ°ú Ï∂îÏ†Å.
- `BaseViewController.bindErrorHandling()` Íµ¨ÎèÖÏù¥ Ï¢ÖÎ£åÎêòÏßÄ ÏïäÏïÑ ÎàÑÏàòÍ∞Ä ÏßÄÏÜçÎêòÎäî Í≤ÉÏùÑ Ïû¨ÌôïÏù∏.
- Leaks ÌÉÄÏûÑÎùºÏù∏ÏóêÏÑú ÎèôÏùº Ï£ºÏÜåÏùò `CurrencyViewController`Í∞Ä Î∞òÎ≥µÏ†ÅÏúºÎ°ú ÏÇ¥ÏïÑ ÏûàÎäî Í≤ÉÏùÑ ÌôïÏù∏.

### 4. Í∑ºÎ≥∏ ÏõêÏù∏ & ÏΩîÎìú ÏàòÏ†ï
- `bindErrorHandling()` ÎÇ¥Î∂Ä `compactMap` ÌÅ¥Î°úÏ†ÄÍ∞Ä `self`Î•º Í∞ïÌïòÍ≤å Ï∫°Ï≤ò.
- `cancellables`Í∞Ä `AnyCancellable`ÏùÑ Í∞ïÌïòÍ≤å Î≥¥Ïú†ÌïòÎ©¥ÏÑú View ‚Üí Combine ‚Üí View Íµ¨Ï°∞Í∞Ä ÏàúÌôò Ï∞∏Ï°∞Î•º ÎßåÎì¶.

```swift
private func bindErrorHandling() {
  viewStore.publisher
    .compactMap { $0.errorMessage }
    .sink { [weak self] message in
      guard let self else { return }
      self.presentError(message)
    }
    .store(in: &cancellables)
}
```
- `[weak self]`Î°ú ÏàòÏ†ïÌï¥ Combine ÌÅ¥Î°úÏ†ÄÍ∞Ä ViewControllerÎ•º ÏïΩÌïòÍ≤å Ï∫°Ï≤òÌïòÎèÑÎ°ù Î≥ÄÍ≤Ω.

### 5. Ìï¥Í≤∞ Ï†Ñ/ÌõÑ ÎπÑÍµê
| Îã®Í≥Ñ | ÎèÑÍµ¨ | Í≤∞Í≥º |
| --- | --- | --- |
| ÏàòÏ†ï Ï†Ñ | Memory Graph Debugger | Pop ÌõÑÏóêÎèÑ `CurrencyViewController`Í∞Ä Ìï¥Ï†úÎêòÏßÄ ÏïäÏùå |
| ÏàòÏ†ï Ï†Ñ | Instruments (Leaks) | ÎèôÏùº Ïù∏Ïä§ÌÑ¥Ïä§Ïùò ÎàÑÏàòÍ∞Ä Í≥ÑÏÜç Î≥¥Í≥†Îê® |
| ÏàòÏ†ï ÌõÑ | Memory Graph Debugger | ÌôîÎ©¥ Ï†ÑÌôò ÌõÑ Ïª®Ìä∏Î°§Îü¨Í∞Ä Ï¶âÏãú Ìï¥Ï†úÎêòÎäî Í≤ÉÏùÑ ÌôïÏù∏ |
| ÏàòÏ†ï ÌõÑ | Instruments (Leaks) | ÎàÑÏàò Ìï≠Î™©Ïù¥ ÏÇ¨ÎùºÏßÄÍ≥† Î©îÎ™®Î¶¨ ÏÇ¨Ïö©ÎüâÏù¥ ÏïàÏ†ï Ïú†ÏßÄ |

> ÏúÑ Í≥ºÏ†ïÏùÑ ÌÜµÌï¥ View ‚Üî Combine Íµ¨ÎèÖ Í∞Ñ Í∞ïÌïú Ï∞∏Ï°∞ ÏàúÌôòÏùÑ Ìï¥ÏÜåÌñàÍ≥†, ÌôîÎ©¥ Ï†ÑÌôòÏùÑ Î∞òÎ≥µÌï¥ÎèÑ Ïª®Ìä∏Î°§Îü¨Í∞Ä Ï¶âÏãú Ìï¥Ï†úÎêòÎäî Í≤ÉÏùÑ ÌôïÏù∏ÌñàÏäµÎãàÎã§.

## ÏïÑÌÇ§ÌÖçÏ≤ò & Í∏∞Ïà† Ïä§ÌÉù
| Í≥ÑÏ∏µ | Í∏∞Ïà† |
| --- | --- |
| ÏÉÅÌÉú Í¥ÄÎ¶¨ | TCA (Composable Architecture) |
| Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû• | SwiftData (`@Model` + ModelContext) |
| ÎÑ§Ìä∏ÏõåÌÅ¨/ÎèÑÎ©îÏù∏ | Repository + UseCase Í≥ÑÏ∏µ Íµ¨Ï°∞ |
| UI Î†àÏù¥ÏïÑÏõÉ | FlexLayout, PinLayout |
| ÌÖåÏä§Ìä∏ | Xcode `.xctestplan` (swift-testing) |

## Ïã§Ìñâ Î∞©Î≤ï
1. `CurrencyConverter.xcodeproj`Î•º XcodeÏóêÏÑú Ïó¥Í∏∞
2. Scheme `CurrencyConverter` ÏÑ†ÌÉù ÌõÑ Ïã§Ìñâ (`‚åò + R`)
3. ÌÖåÏä§Ìä∏Îäî `CurrencyConverter.xctestplan`ÏùÑ Ïù¥Ïö©Ìï¥ Ï†ÑÏ≤¥ Ïã§Ìñâ (`‚åò + U`)

> ‚ö†Ô∏è ÌîÑÎ°úÏ†ùÌä∏Îäî Swift Package Manager Í∏∞Î∞òÏù¥ ÏïÑÎãàÎØÄÎ°ú `swift test`Îäî ÏÇ¨Ïö©ÌïòÏßÄ ÏïäÏäµÎãàÎã§.

## ÌôòÏú® Ìä∏Î†åÎìú Í≥ÑÏÇ∞ ÌùêÎ¶Ñ
```swift
private func computeTrends(
  newRates: [String: Double],
  previousRates: [String: Double]
) -> [String: RateTrend] {
  newRates.reduce(into: [String: RateTrend]()) { result, entry in
    let previous = previousRates[entry.key] ?? entry.value
    let diff = entry.value - previous
    result[entry.key] = RateTrend(difference: diff)
  }
}
```

## SwiftData Ï†ÄÏû• Ï†ÑÎûµ
```swift
@Model
final class LastViewedScreenEntity {
  @Attribute(.unique) var id: String = "singleton"
  var type: ScreenType
  var currencyCode: String?
  var exchangeRate: Double?

  init(type: ScreenType, currencyCode: String?, exchangeRate: Double?) {
    self.type = type
    self.currencyCode = currencyCode
    self.exchangeRate = exchangeRate
  }
}

func persistLastScreen(_ screen: LastViewedScreen, context: ModelContext) async {
  await context.perform {
    try? context.delete(model: LastViewedScreenEntity.self)
    let entity = LastViewedScreenEntity(
      type: screen.type,
      currencyCode: screen.currencyCode,
      exchangeRate: screen.exchangeRate
    )
    context.insert(entity)
    try? context.save()
  }
}
```

## ProductCell Î†àÏù¥ÏïÑÏõÉ Ï°∞Ï†ï
```swift
row.addItem(priceLabel).shrink(0).marginLeft(4)
row.addItem(trendImageView)
  .width(Layout.trendWidth)
  .height(Layout.trendWidth)
  .marginLeft(4)
```

